{"cells":[{"cell_type":"markdown","metadata":{"id":"kv6gH7G01Pal"},"source":["## Numpy"]},{"cell_type":"markdown","metadata":{"id":"RQWkeQgD1Pam"},"source":["### 1. Numpy Array and Operation"]},{"cell_type":"markdown","metadata":{"id":"igGUA1oE1Pam"},"source":["- numpy의 기본적인 사용법에 대해서 배워봅니다.\n","\n","\n","- numpy에서 numpy.array를 만드는 여러가지 방법과 지원하는 연산자에 대해서 공부합니다."]},{"cell_type":"markdown","source":["### 1.1. Numpy Array creation"],"metadata":{"id":"ZzPzxgQ53PcS"}},{"cell_type":"code","execution_count":1,"metadata":{"id":"MoD6QOXY1Pan","executionInfo":{"status":"ok","timestamp":1682868525590,"user_tz":-540,"elapsed":48,"user":{"displayName":"kiyong park","userId":"03524589898640390729"}}},"outputs":[],"source":["# numpy 라이브러리를 불러옵니다.\n","import numpy as np "]},{"cell_type":"code","execution_count":2,"metadata":{"id":"bqVEQaBP1Pan","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1682868525590,"user_tz":-540,"elapsed":48,"user":{"displayName":"kiyong park","userId":"03524589898640390729"}},"outputId":"d9e9786d-1a3f-4df9-9fbe-a4476fc388e5"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["[1, 2, 3, 4, 5]"]},"metadata":{},"execution_count":2}],"source":["# 파이썬 리스트 선언\n","data = [1,2,3,4,5]\n","data"]},{"cell_type":"code","execution_count":3,"metadata":{"id":"jADukVLG1Pan","executionInfo":{"status":"ok","timestamp":1682868525591,"user_tz":-540,"elapsed":48,"user":{"displayName":"kiyong park","userId":"03524589898640390729"}},"colab":{"base_uri":"https://localhost:8080/"},"outputId":"5f5c2a16-08ba-4f2a-f5d4-6bfd479dde65"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["[[1, 2], [3, 4]]"]},"metadata":{},"execution_count":3}],"source":["# 파이썬 2차원 리스트(행렬) 선언\n","data2 = [[1,2],[3,4]]\n","data2"]},{"cell_type":"code","execution_count":4,"metadata":{"id":"jQq60ZfX1Pan","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1682868525591,"user_tz":-540,"elapsed":41,"user":{"displayName":"kiyong park","userId":"03524589898640390729"}},"outputId":"cc009882-050e-43e9-921b-edd94845d924"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([1, 2, 3, 4, 5])"]},"metadata":{},"execution_count":4}],"source":["# 파이썬 list를 numpy array로 변환합니다.\n","arr = np.array(data)\n","# numpy array를 만드는 방식의 대부분은 파이썬 리스트를 np.array로 변환하는 방식입니다.\n","arr "]},{"cell_type":"code","execution_count":5,"metadata":{"id":"eqbxPjfu1Pao","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1682868525592,"user_tz":-540,"elapsed":39,"user":{"displayName":"kiyong park","userId":"03524589898640390729"}},"outputId":"1533eb85-2e20-489a-bbc4-fc16528e5e06"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([[1, 2],\n","       [3, 4]])"]},"metadata":{},"execution_count":5}],"source":["# 2차원 리스트를 np.array로 만듭니다.\n","arr2 = np.array(data2) # data2라는 리스트를 numpy array로 만들어라.\n","arr2  ## 2차원 numpy array => 행렬 , 2개의 행과 2개의 열 을 가진 배열"]},{"cell_type":"code","execution_count":6,"metadata":{"id":"oMdYjtc21Pao","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1682868525592,"user_tz":-540,"elapsed":35,"user":{"displayName":"kiyong park","userId":"03524589898640390729"}},"outputId":"c54280f8-22bc-4c8a-aedf-22d683761f24"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])"]},"metadata":{},"execution_count":6}],"source":["# 0부터 9까지 숫자를 자동으로 생성한 array\n","# np.array(range(10))\n","np.arange(10)"]},{"cell_type":"code","execution_count":7,"metadata":{"id":"NwMSPz0Z1Pao","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1682868525593,"user_tz":-540,"elapsed":31,"user":{"displayName":"kiyong park","userId":"03524589898640390729"}},"outputId":"ab1a3537-9ccf-45ae-e08b-a85173088712"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26,\n","       27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43,\n","       44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60,\n","       61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77,\n","       78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94,\n","       95, 96, 97, 98, 99])"]},"metadata":{},"execution_count":7}],"source":["# 10부터 99까지 숫자를 자동으로 생성한 array\n","np.arange(10,100)"]},{"cell_type":"code","source":["print(arr.shape)  ## 행렬의 구조를 확이 할 수 있는  shape , 5개의 행을 가진 배열\n","print(arr2.shape) ## 2개의 행과 2개의 열을 가진 배열."],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"f7gO-43C_jh3","executionInfo":{"status":"ok","timestamp":1682868525593,"user_tz":-540,"elapsed":26,"user":{"displayName":"kiyong park","userId":"03524589898640390729"}},"outputId":"13b9ff4f-32b2-4b46-c6f9-17a94231a649"},"execution_count":8,"outputs":[{"output_type":"stream","name":"stdout","text":["(5,)\n","(2, 2)\n"]}]},{"cell_type":"code","source":["print(arr2.ndim) # 2차원. \n","print(arr.ndim) # 1차원."],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"02rdGvEPi3W_","executionInfo":{"status":"ok","timestamp":1682868525595,"user_tz":-540,"elapsed":24,"user":{"displayName":"kiyong park","userId":"03524589898640390729"}},"outputId":"814a0e0f-2b00-42d7-9815-b2ad58a59920"},"execution_count":9,"outputs":[{"output_type":"stream","name":"stdout","text":["2\n","1\n"]}]},{"cell_type":"code","source":["type(arr2)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"Fa1y5TVOjPLn","executionInfo":{"status":"ok","timestamp":1682868525598,"user_tz":-540,"elapsed":24,"user":{"displayName":"kiyong park","userId":"03524589898640390729"}},"outputId":"db5d7da3-eceb-4d91-95e0-a481b2dcc118"},"execution_count":10,"outputs":[{"output_type":"execute_result","data":{"text/plain":["numpy.ndarray"]},"metadata":{},"execution_count":10}]},{"cell_type":"markdown","metadata":{"id":"UFFwSitw1Pao"},"source":["### 1.2. Reshaping array"]},{"cell_type":"code","execution_count":11,"metadata":{"id":"-vcHHFl81Pao","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1682868525603,"user_tz":-540,"elapsed":24,"user":{"displayName":"kiyong park","userId":"03524589898640390729"}},"outputId":"1dae9d10-e824-48a2-9e75-14f2069ef16b"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([[1, 2, 3],\n","       [4, 5, 6],\n","       [7, 8, 9]])"]},"metadata":{},"execution_count":11}],"source":["# 3 x 3 행렬을 만들어봅시다.\n","# 이렇게 하면 귀찮음.\n","x = np.array ([[1,2,3],\n","               [4,5,6],\n","               [7,8,9]])\n","x"]},{"cell_type":"code","execution_count":12,"metadata":{"id":"HChX3Sv91Pao","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1682868526335,"user_tz":-540,"elapsed":752,"user":{"displayName":"kiyong park","userId":"03524589898640390729"}},"outputId":"3d99fbe6-5bec-4a00-ddbb-71bd54c25d76"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([[1, 2, 3],\n","       [4, 5, 6],\n","       [7, 8, 9]])"]},"metadata":{},"execution_count":12}],"source":["# reshape을 이용하여 만들어봅시다.\n","np.arange(1,10).reshape(3,3) ##(9,) 데이터를 -> (3,3) 로 shape 변경"]},{"cell_type":"code","source":["# row vector를 column vector로\n","np.arange(6).reshape(6,1)"],"metadata":{"id":"jKHQRaFx5QFT","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1682868526335,"user_tz":-540,"elapsed":200,"user":{"displayName":"kiyong park","userId":"03524589898640390729"}},"outputId":"fb97a96f-c5dc-4b22-bc70-88f0b79577e0"},"execution_count":13,"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([[0],\n","       [1],\n","       [2],\n","       [3],\n","       [4],\n","       [5]])"]},"metadata":{},"execution_count":13}]},{"cell_type":"code","source":["# 펼치기\n","x.shape\n","x.reshape(3,-1) # reshape 에 -1 을 넣는 경우 , 알아서 형태를 잡는다. "],"metadata":{"id":"Jre4TnZT5YwK","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1682869385390,"user_tz":-540,"elapsed":10,"user":{"displayName":"kiyong park","userId":"03524589898640390729"}},"outputId":"8cb4c668-17eb-4efb-e887-effcfd025e4d"},"execution_count":59,"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([[1, 2, 3],\n","       [4, 5, 6],\n","       [7, 8, 9]])"]},"metadata":{},"execution_count":59}]},{"cell_type":"code","source":["# 무조건 1차원 배열로 만들기 \n","x.flatten()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"2Q5SBtPt1R9G","executionInfo":{"status":"ok","timestamp":1682869435400,"user_tz":-540,"elapsed":14,"user":{"displayName":"kiyong park","userId":"03524589898640390729"}},"outputId":"4a29ed28-4a6a-426b-ae11-01b8753f0e36"},"execution_count":61,"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([1, 2, 3, 4, 5, 6, 7, 8, 9])"]},"metadata":{},"execution_count":61}]},{"cell_type":"code","source":["#전치행렬\n","x.T"],"metadata":{"id":"ZnDyTH5n_l3C","executionInfo":{"status":"ok","timestamp":1682872111468,"user_tz":-540,"elapsed":5,"user":{"displayName":"kiyong park","userId":"03524589898640390729"}},"outputId":"7d94d945-fade-44a9-b04d-1076454e43a5","colab":{"base_uri":"https://localhost:8080/"}},"execution_count":94,"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([[1, 4, 7],\n","       [2, 5, 8],\n","       [3, 6, 9]])"]},"metadata":{},"execution_count":94}]},{"cell_type":"markdown","metadata":{"id":"MMrKtZy-1Pao"},"source":["### 1.3. Concatenation of arrays"]},{"cell_type":"code","execution_count":15,"metadata":{"id":"6g1bOHDn1Pao","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1682868526336,"user_tz":-540,"elapsed":193,"user":{"displayName":"kiyong park","userId":"03524589898640390729"}},"outputId":"82d1a952-7ed2-421a-d0b8-0fbf1acefa41"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([[1, 2, 3],\n","       [4, 5, 6]])"]},"metadata":{},"execution_count":15}],"source":["arr1 = np.array([1, 2, 3])\n","arr2 = np.array([4, 5, 6])\n","# arr1 + arr2 = ?\n","arr1 + arr2  # 벡터 연산이 된다\n","# arr1와 arr2를 합칩니다\n","np.concatenate([arr1,arr2]).reshape(2,3)\n"]},{"cell_type":"code","execution_count":16,"metadata":{"id":"ePV80Pwx1Pao","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1682868526336,"user_tz":-540,"elapsed":186,"user":{"displayName":"kiyong park","userId":"03524589898640390729"}},"outputId":"60828f62-4ff7-4f94-b1f8-b41e8d085cfe"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([[1, 2, 3],\n","       [4, 5, 6]])"]},"metadata":{},"execution_count":16}],"source":["# stacking vertically\n","np.vstack([arr1,arr2])"]},{"cell_type":"code","execution_count":17,"metadata":{"id":"xcY9pR2M1Pap","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1682868526337,"user_tz":-540,"elapsed":183,"user":{"displayName":"kiyong park","userId":"03524589898640390729"}},"outputId":"a9acdc15-74f0-4af7-9c8f-88a81b107f07"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([1, 2, 3, 4, 5, 6])"]},"metadata":{},"execution_count":17}],"source":["# stacking horizontally\n","np.hstack([arr1,arr2])"]},{"cell_type":"markdown","metadata":{"id":"1Pioy4a-1Pap"},"source":["## 1.4. Array Arithmetic (like vector) --> Universal Function"]},{"cell_type":"code","execution_count":18,"metadata":{"id":"sxjF6pdh1Pap","executionInfo":{"status":"ok","timestamp":1682868526337,"user_tz":-540,"elapsed":179,"user":{"displayName":"kiyong park","userId":"03524589898640390729"}}},"outputs":[],"source":["# v1 = (1, 2, 3), v2 = (4, 5, 6) 벡터 2개 생성하기.\n","v1 = np.array([1, 2, 3])\n","v2 = np.array([4, 5, 6])"]},{"cell_type":"code","execution_count":19,"metadata":{"id":"KFKEKB711Pap","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1682868526337,"user_tz":-540,"elapsed":179,"user":{"displayName":"kiyong park","userId":"03524589898640390729"}},"outputId":"6d7f9969-a7a7-4935-e7a6-011e44bc7e22"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([5, 7, 9])"]},"metadata":{},"execution_count":19}],"source":["# 리스트로 더하기 연산해보기\n","v1 + v2"]},{"cell_type":"code","execution_count":20,"metadata":{"id":"UiDh2wZX1Pap","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1682868526338,"user_tz":-540,"elapsed":172,"user":{"displayName":"kiyong park","userId":"03524589898640390729"}},"outputId":"3d3ce024-0486-4bbe-fa37-faccba00c23f"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([5, 7, 9])"]},"metadata":{},"execution_count":20}],"source":["#  vector addition\n","v1 + v2"]},{"cell_type":"code","execution_count":21,"metadata":{"id":"z1uh1zIW1Pap","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1682868526338,"user_tz":-540,"elapsed":168,"user":{"displayName":"kiyong park","userId":"03524589898640390729"}},"outputId":"45e4d65d-9fd0-4679-bb9f-b6edb6ab5b2c"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([-3, -3, -3])"]},"metadata":{},"execution_count":21}],"source":["#  vector subtraction\n","v1 - v2"]},{"cell_type":"code","execution_count":22,"metadata":{"id":"Kp3n7JU91Pap","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1682868526338,"user_tz":-540,"elapsed":164,"user":{"displayName":"kiyong park","userId":"03524589898640390729"}},"outputId":"65507980-1f2b-418d-e5bc-c1b2eb25b1e2"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([ 4, 10, 18])"]},"metadata":{},"execution_count":22}],"source":["# (not vector operation) elementwise multiplication , 행렬곱)\n","v1 * v2"]},{"cell_type":"code","execution_count":23,"metadata":{"id":"WQDxd6ew1Pap","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1682868526339,"user_tz":-540,"elapsed":156,"user":{"displayName":"kiyong park","userId":"03524589898640390729"}},"outputId":"9c89f06d-dc18-494a-d8ce-22613a6de26a"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([0.25, 0.4 , 0.5 ])"]},"metadata":{},"execution_count":23}],"source":["# (not vector operation) elementwise division , 행렬나눗셈\n","v1 / v2 "]},{"cell_type":"code","execution_count":24,"metadata":{"id":"Kh9DEujN1Pap","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1682868526339,"user_tz":-540,"elapsed":152,"user":{"displayName":"kiyong park","userId":"03524589898640390729"}},"outputId":"f962e630-6f46-4ebe-b30e-4eb2a5fe50b4"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["32"]},"metadata":{},"execution_count":24}],"source":["# dot product. 벡터의 내적 곱. (1x4 + 2x5 + 3x6 )\n","v1 @ v2"]},{"cell_type":"markdown","metadata":{"id":"Dp11IV1l1Pap"},"source":["### 1.5. Broadcast and Universal Function"]},{"cell_type":"markdown","metadata":{"id":"lbGKwuWf1Pap"},"source":["- 서로 크기가 다른 numpy array를 연산할 때, 자동으로 연산을 전파(broadcast)해주는 기능. 행렬곱 연산을 할 때 편리하다."]},{"cell_type":"code","execution_count":25,"metadata":{"id":"g8pG0d-V1Paq","executionInfo":{"status":"ok","timestamp":1682868526340,"user_tz":-540,"elapsed":149,"user":{"displayName":"kiyong park","userId":"03524589898640390729"}}},"outputs":[],"source":["arr1 = np.array([1,2,3])"]},{"cell_type":"code","execution_count":26,"metadata":{"id":"CQDgu7vG1Paq","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1682868526340,"user_tz":-540,"elapsed":148,"user":{"displayName":"kiyong park","userId":"03524589898640390729"}},"outputId":"8e378823-2387-4591-a05b-77b0c8ee0fda"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["(2, 3)"]},"metadata":{},"execution_count":26}],"source":["arr2 = np.array([[-1, -1, -1],\n","                 [1 , 1, 1]])\n","arr2.shape "]},{"cell_type":"code","execution_count":27,"metadata":{"id":"-4EWUAZB1Paq","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1682868526340,"user_tz":-540,"elapsed":143,"user":{"displayName":"kiyong park","userId":"03524589898640390729"}},"outputId":"7067858e-6ae6-445f-f59f-56effee10927"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([[0, 1, 2],\n","       [2, 3, 4]])"]},"metadata":{},"execution_count":27}],"source":["# 2개의 array를 더해보면?\n","arr1 + arr2 # 2->2->3(v)"]},{"cell_type":"code","execution_count":28,"metadata":{"id":"EvOolsHz1Paq","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1682868526341,"user_tz":-540,"elapsed":140,"user":{"displayName":"kiyong park","userId":"03524589898640390729"}},"outputId":"4d2c447c-19b9-4f44-c70c-03c410b04c3a"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([[-1, -2, -3],\n","       [ 1,  2,  3]])"]},"metadata":{},"execution_count":28}],"source":["# 2개의 array를 곱해보면? (**)\n","arr1 * arr2"]},{"cell_type":"markdown","source":["- Universal Function : broadcast 기능을 확장해서, numpy array의 모든 원소에 동일한 함수를 반복문으로 적용한 것과 같은 효과를 내는 기능."],"metadata":{"id":"Rch_pHQW55S-"}},{"cell_type":"code","source":["## for 문을 적용해서 각 원소들을 계산 했을때 \n","# f = lambda x : 1/x\n","\n","# arr1 = np.array([1. , 2. , 3. ])\n","\n","# for i in range(arr1.shape[0]):\n","#   arr1[i] = f(arr1[i])\n","\n","# universial function 을 사용 해서 했을때 --> 빠르고 편리하다. for문을 자주 쓰는건 느릴 수 밖에 없음.\n","arr1 = np.array([1. ,2. ,3.])\n","print ( 1/ arr1 )"],"metadata":{"id":"AeXAfqUI6H0V","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1682868526341,"user_tz":-540,"elapsed":136,"user":{"displayName":"kiyong park","userId":"03524589898640390729"}},"outputId":"8dc988fc-743e-4448-f3f8-a6543310a781"},"execution_count":29,"outputs":[{"output_type":"stream","name":"stdout","text":["[1.         0.5        0.33333333]\n"]}]},{"cell_type":"code","execution_count":30,"metadata":{"id":"xt20aKq21Paq","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1682868526341,"user_tz":-540,"elapsed":132,"user":{"displayName":"kiyong park","userId":"03524589898640390729"}},"outputId":"9383ad70-003f-492b-a08c-c9978a25dc78"},"outputs":[{"output_type":"stream","name":"stdout","text":["[[ 2.  4.  6.]\n"," [ 8. 16. 18.]]\n"]}],"source":["# f = lambda x : x * 2\n","arr1 = np.array([[1. ,2. ,3.],[4. , 8. , 9.]])\n","print ( 2 * arr1 )\n"]},{"cell_type":"markdown","metadata":{"id":"JQ9vQmo-1Paq"},"source":["### 1.6. Indexing\n"," - numpy array의 인덱싱은 파이썬 인덱싱 과 같다."]},{"cell_type":"code","execution_count":31,"metadata":{"id":"C2U2Y3Sz1Paq","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1682868526342,"user_tz":-540,"elapsed":129,"user":{"displayName":"kiyong park","userId":"03524589898640390729"}},"outputId":"c42596ee-66f4-4dfd-efc3-5dc5a3f621e2"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])"]},"metadata":{},"execution_count":31}],"source":["arr1 = np.arange(10)\n","arr1"]},{"cell_type":"code","execution_count":32,"metadata":{"id":"5WULHYrI1Paq","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1682868526342,"user_tz":-540,"elapsed":125,"user":{"displayName":"kiyong park","userId":"03524589898640390729"}},"outputId":"278d8cc4-ac8e-4232-fad9-20d292e9fcce"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["0"]},"metadata":{},"execution_count":32}],"source":["# 첫번째 원소\n","arr1[0]"]},{"cell_type":"code","execution_count":33,"metadata":{"id":"_N-nEw7V1Paq","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1682868526342,"user_tz":-540,"elapsed":121,"user":{"displayName":"kiyong park","userId":"03524589898640390729"}},"outputId":"454bc8d6-ac1d-45d8-f574-a0b547b3f104"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["9"]},"metadata":{},"execution_count":33}],"source":["# 마지막 원소\n","arr1[-1]"]},{"cell_type":"code","execution_count":34,"metadata":{"id":"wNQa8qoO1Paq","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1682868526343,"user_tz":-540,"elapsed":117,"user":{"displayName":"kiyong park","userId":"03524589898640390729"}},"outputId":"35d4e63e-fb6e-4aea-efbe-5ce736218a67"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([0, 1, 2])"]},"metadata":{},"execution_count":34}],"source":["# 앞에서부터 원소 3개 slicing\n","arr1[:3]"]},{"cell_type":"code","execution_count":35,"metadata":{"id":"29pYfFvL1Paq","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1682868526343,"user_tz":-540,"elapsed":110,"user":{"displayName":"kiyong park","userId":"03524589898640390729"}},"outputId":"740d8fdc-c820-4424-c606-c891d02bde20"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([[ 1,  2,  3,  4],\n","       [ 5,  6,  7,  8],\n","       [ 9, 10, 11, 12]])"]},"metadata":{},"execution_count":35}],"source":["arr2 = np.array([[1, 2, 3, 4],\n","               [5, 6, 7, 8],\n","               [9, 10, 11, 12]])\n","arr2"]},{"cell_type":"code","execution_count":36,"metadata":{"id":"p8EFXNq91Paq","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1682868526344,"user_tz":-540,"elapsed":104,"user":{"displayName":"kiyong park","userId":"03524589898640390729"}},"outputId":"1bd342c1-2a20-4409-d064-d1181ad62361"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["12"]},"metadata":{},"execution_count":36}],"source":["# arr2의 3row, 4column 원소\n","# 파이썬 인덱싱 해보자 ( 배운것 처럼)\n","# arr2[2][3]\n","arr2[2, 3]  # numpy indexig 에서 추가 된것. "]},{"cell_type":"code","execution_count":37,"metadata":{"id":"OVgw4bT11Paq","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1682868526345,"user_tz":-540,"elapsed":99,"user":{"displayName":"kiyong park","userId":"03524589898640390729"}},"outputId":"6cb0c6de-528a-49ce-942f-7f551ee4c7b6"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([ 2,  6, 10])"]},"metadata":{},"execution_count":37}],"source":["# arr2의 세번째 column [3, 7, 11] . 다른것도 해보자 ..\n","arr2 [:,1]"]},{"cell_type":"code","execution_count":38,"metadata":{"id":"krLo7Tvg1Paq","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1682868526345,"user_tz":-540,"elapsed":95,"user":{"displayName":"kiyong park","userId":"03524589898640390729"}},"outputId":"54168ba8-10e6-480b-d859-899f140d82bf"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([5, 6, 7, 8])"]},"metadata":{},"execution_count":38}],"source":["# arr2의 두번째 row\n","arr2 [1,:]"]},{"cell_type":"markdown","metadata":{"id":"nb3NOpgU1Par"},"source":["## 2. Numpy Methods\n","\n","- numpy에서 사용되는 여러가지 함수들을 사용해봅시다."]},{"cell_type":"markdown","metadata":{"id":"wsDCnH9Q1Par"},"source":["### 2.1. Math Functions "]},{"cell_type":"code","execution_count":39,"metadata":{"id":"Pme3p6FQ1Par","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1682868526346,"user_tz":-540,"elapsed":92,"user":{"displayName":"kiyong park","userId":"03524589898640390729"}},"outputId":"342855c9-7d9f-46c1-f6ae-587714aec933"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([[ 2.49282106e-01,  1.49571279e+00,  2.19940705e-01],\n","       [ 6.03145195e-01,  6.23320816e-01,  7.58013171e-01],\n","       [-1.43962659e+00, -2.63654780e-01,  9.83701653e-01],\n","       [ 3.42931902e-02, -2.04628990e+00, -9.18929636e-01],\n","       [-9.58703214e-01,  1.49992145e-03, -3.56252793e-01]])"]},"metadata":{},"execution_count":39}],"source":["# 표준정규분포에서 random sampling을 한 원소를 가지는 5x3 행렬을 만든다.\n","## 파이썬 에서 하려면 필요한 수치해석 라이브러리를 일일이 불러 와야 함. \n","mat1 = np.random.randn(5,3)\n","mat1"]},{"cell_type":"code","execution_count":40,"metadata":{"id":"YnWulebZ1Par","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1682868526346,"user_tz":-540,"elapsed":88,"user":{"displayName":"kiyong park","userId":"03524589898640390729"}},"outputId":"994d8991-1a92-4d19-a59e-59f7a1b2f71f"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([[2.49282106e-01, 1.49571279e+00, 2.19940705e-01],\n","       [6.03145195e-01, 6.23320816e-01, 7.58013171e-01],\n","       [1.43962659e+00, 2.63654780e-01, 9.83701653e-01],\n","       [3.42931902e-02, 2.04628990e+00, 9.18929636e-01],\n","       [9.58703214e-01, 1.49992145e-03, 3.56252793e-01]])"]},"metadata":{},"execution_count":40}],"source":["# mat1에 절대값 씌우기 (원소들의 절대값 ,)\n","np.abs(mat1)"]},{"cell_type":"code","source":["# mat1 제곱하기 \n","np.square(mat1)"],"metadata":{"id":"LEt94K-t6sdK","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1682868526347,"user_tz":-540,"elapsed":85,"user":{"displayName":"kiyong park","userId":"03524589898640390729"}},"outputId":"aea64754-7335-4853-9eb2-7daafaa522fe"},"execution_count":41,"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([[6.21415684e-02, 2.23715674e+00, 4.83739136e-02],\n","       [3.63784126e-01, 3.88528840e-01, 5.74583968e-01],\n","       [2.07252472e+00, 6.95138432e-02, 9.67668943e-01],\n","       [1.17602289e-03, 4.18730235e+00, 8.44431676e-01],\n","       [9.19111852e-01, 2.24976436e-06, 1.26916053e-01]])"]},"metadata":{},"execution_count":41}]},{"cell_type":"code","source":["# mat1의 제곱근 구하기 \n","np.sqrt(mat1) "],"metadata":{"id":"mFldaHe_6wHC","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1682868526347,"user_tz":-540,"elapsed":81,"user":{"displayName":"kiyong park","userId":"03524589898640390729"}},"outputId":"da4db039-0877-4281-f54a-4f7637cddafc"},"execution_count":42,"outputs":[{"output_type":"stream","name":"stderr","text":["<ipython-input-42-49b3ed328ce5>:2: RuntimeWarning: invalid value encountered in sqrt\n","  np.sqrt(mat1)\n"]},{"output_type":"execute_result","data":{"text/plain":["array([[0.49928159, 1.22299337, 0.46897836],\n","       [0.77662423, 0.78950669, 0.87063952],\n","       [       nan,        nan, 0.99181735],\n","       [0.18518421,        nan,        nan],\n","       [       nan, 0.03872882,        nan]])"]},"metadata":{},"execution_count":42}]},{"cell_type":"code","source":["# linear algebra functions ( 선형 대수학 예시 )\n","vec = np.array([1,3,4])\n","\n","# 1. norm ( 벡터의 크기 )\n","np.linalg.norm(vec) # L2 norm\n","\n","# 2. eigenvalue ( 고유값)\n","mat = np.array([[2,3],\n","               [3,2]])\n","np.linalg.eig(mat)\n","## 이런것도 된다 정도 생각 하고 넘어 가자."],"metadata":{"id":"khqI2kwA62Ez","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1682868526347,"user_tz":-540,"elapsed":76,"user":{"displayName":"kiyong park","userId":"03524589898640390729"}},"outputId":"d0f5d3aa-29b6-46fe-ff99-6e813c5529ab"},"execution_count":43,"outputs":[{"output_type":"execute_result","data":{"text/plain":["(array([ 5., -1.]),\n"," array([[ 0.70710678, -0.70710678],\n","        [ 0.70710678,  0.70710678]]))"]},"metadata":{},"execution_count":43}]},{"cell_type":"markdown","metadata":{"id":"Tk5S0yOf1Par"},"source":["### 2.2. Aggregation functions "]},{"cell_type":"code","execution_count":44,"metadata":{"id":"b0ei5LJ51Par","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1682868526348,"user_tz":-540,"elapsed":73,"user":{"displayName":"kiyong park","userId":"03524589898640390729"}},"outputId":"3ce8523a-d020-4312-a457-73c07ce86315"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([[0.91903214, 0.3996075 ],\n","       [0.27660952, 0.06609631],\n","       [0.58086866, 0.77759311]])"]},"metadata":{},"execution_count":44}],"source":["mat2 = np.random.rand(3, 2)\n","mat2"]},{"cell_type":"code","execution_count":45,"metadata":{"id":"hMKOS5O51Par","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1682868526348,"user_tz":-540,"elapsed":69,"user":{"displayName":"kiyong park","userId":"03524589898640390729"}},"outputId":"90f34164-e5ca-4c3f-ed43-dc50d4217d85"},"outputs":[{"output_type":"stream","name":"stdout","text":["[1.31863964 0.34270583 1.35846177]\n","[1.77651032 1.24329692]\n"]}],"source":["# Summation\n","# np.sum(mat2)\n","print(np.sum(mat2 ,axis=1)) #column : axis 는 기억 해두자 꼭!!!!\n","print(np.sum(mat2 ,axis=0)) #row"]},{"cell_type":"code","execution_count":46,"metadata":{"id":"OdJZdrx_1Par","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1682868526348,"user_tz":-540,"elapsed":65,"user":{"displayName":"kiyong park","userId":"03524589898640390729"}},"outputId":"06b5bcd8-ddad-4466-a583-0abc04448f15"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([0.59217011, 0.41443231])"]},"metadata":{},"execution_count":46}],"source":["# mean\n","np.mean(mat2, axis=0)"]},{"cell_type":"code","execution_count":47,"metadata":{"id":"78xMuXMY1Par","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1682868526349,"user_tz":-540,"elapsed":62,"user":{"displayName":"kiyong park","userId":"03524589898640390729"}},"outputId":"f823d340-2b14-4d11-9a8c-84ff693820b4"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["0.9235654260681944"]},"metadata":{},"execution_count":47}],"source":["# std (표준편차)\n","np.std(mat1)"]},{"cell_type":"code","source":["# randn (표준정규분포를 따르는 난수를 생성)\n","np.random.randn(100)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"noCRcNIF-VHE","executionInfo":{"status":"ok","timestamp":1682871849942,"user_tz":-540,"elapsed":12,"user":{"displayName":"kiyong park","userId":"03524589898640390729"}},"outputId":"a10f779b-6d38-48ca-d719-56a4212d27a1"},"execution_count":93,"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([ 0.5491572 , -0.18203949, -0.78383892,  1.34404038,  0.75779214,\n","        0.59405927,  0.39116921,  0.11856817, -0.49275443, -1.03437222,\n","       -2.15543921,  0.52398572, -0.79434067, -0.60938665,  1.3982719 ,\n","        0.21103098, -0.37138648, -1.16579641,  0.49725244, -1.39700846,\n","        0.48783116,  1.82847303,  0.767344  ,  0.79961049, -1.34244255,\n","        1.04290694,  0.10032658,  0.66595915,  0.2894772 , -0.06014576,\n","       -1.05398917,  0.46513905,  0.16499864, -0.15897203,  0.28001366,\n","       -0.52740733,  0.25521583, -0.47609038,  1.48713143,  1.00111806,\n","       -1.14428628, -0.76730651, -0.22898155, -1.66161589, -0.26367533,\n","       -1.51428997, -0.42284454, -1.39168584, -1.0041343 ,  0.05023717,\n","       -0.0379026 , -0.98879483, -0.91283457,  0.26953336,  1.3734518 ,\n","        1.58490319,  1.92094717,  0.09473698, -0.43073744,  1.55701122,\n","       -0.74530881, -1.70975672, -1.77007342,  1.27143844, -0.90911423,\n","        0.92528109,  0.21635766,  1.29645636,  0.25885975,  0.34117705,\n","        1.19709351, -0.7083362 , -0.63365532,  0.33128829,  0.74609496,\n","       -1.60777771,  0.06221493,  0.93242733,  0.82978158,  0.39377877,\n","        0.58541816, -0.09052502, -0.97164207,  0.51508704, -0.53522346,\n","       -0.916361  , -1.010044  , -0.25452448, -1.92161085, -0.45445843,\n","        0.55159918, -0.26347501,  0.2111947 , -0.09208533, -0.56801269,\n","       -0.56003934,  1.25394416, -0.60387652,  0.51634832,  1.48926848])"]},"metadata":{},"execution_count":93}]},{"cell_type":"code","execution_count":48,"metadata":{"id":"KzfPurFc1Par","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1682868526349,"user_tz":-540,"elapsed":58,"user":{"displayName":"kiyong park","userId":"03524589898640390729"}},"outputId":"5fed4b6c-e19a-4bd0-c90c-86f9781af348"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([0.3996075 , 0.06609631, 0.58086866])"]},"metadata":{},"execution_count":48}],"source":["# min, max\n","np.min(mat2,axis=1)"]},{"cell_type":"code","execution_count":49,"metadata":{"id":"YtRtiSG31Pas","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1682868526349,"user_tz":-540,"elapsed":54,"user":{"displayName":"kiyong park","userId":"03524589898640390729"}},"outputId":"b9aa8462-b89f-4d8d-c451-57ec1acdebc8"},"outputs":[{"output_type":"stream","name":"stdout","text":["[1 1]\n","[0 0 1]\n"]}],"source":["# 최소값이 있는 Index\n","print(np.argmin(mat2 , axis= 0))\n","print(np.argmax(mat2 , axis= 1))"]},{"cell_type":"code","execution_count":50,"metadata":{"id":"0cndLCKl1Pas","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1682868526350,"user_tz":-540,"elapsed":50,"user":{"displayName":"kiyong park","userId":"03524589898640390729"}},"outputId":"d55c3e8b-ee46-4a6a-db62-f700509aed22"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([0, 0, 1])"]},"metadata":{},"execution_count":50}],"source":["# 최대값이 있는 Index\n","np.argmax(mat2 , axis= 1)"]},{"cell_type":"code","execution_count":51,"metadata":{"id":"y2LVvF5b1Pas","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1682868526350,"user_tz":-540,"elapsed":46,"user":{"displayName":"kiyong park","userId":"03524589898640390729"}},"outputId":"f28e4734-0ffc-43b8-c05b-fa9c1620ca32"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([[0.91903214, 0.77759311],\n","       [0.58086866, 0.3996075 ],\n","       [0.27660952, 0.06609631]])"]},"metadata":{},"execution_count":51}],"source":["# 그냥 정렬 (오름차순 정렬만 지원합니다)\n","np.sort(mat2 , axis=0)\n","\n","# 내림차순\n","np.sort(mat2 , axis=0)[::-1]"]},{"cell_type":"code","execution_count":52,"metadata":{"id":"mLeMOv7f1Pas","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1682868526350,"user_tz":-540,"elapsed":41,"user":{"displayName":"kiyong park","userId":"03524589898640390729"}},"outputId":"0b4fb94e-98e7-478e-f33b-5a642e04431a"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([[1, 1],\n","       [2, 0],\n","       [0, 2]])"]},"metadata":{},"execution_count":52}],"source":["# index를 정렬 , sorting 된 값이 원래 있던 위치 를 표현\n","np.argsort(mat2 ,axis=0)"]},{"cell_type":"markdown","metadata":{"id":"2a2AgVdm1Pas"},"source":["## 3. \bPerformance Check"]},{"cell_type":"markdown","metadata":{"id":"ciO_FLLW1Pas"},"source":["- Universal Function 기능을 통해 반복문을 사용한 것보다 훨씬 빠른 성능을 냅니다.\n","\n","\n","- 직접 실험을 통해 그 차이를 확인해보겠습니다."]},{"cell_type":"code","execution_count":53,"metadata":{"id":"oVBZX1U31Pas","executionInfo":{"status":"ok","timestamp":1682868526351,"user_tz":-540,"elapsed":37,"user":{"displayName":"kiyong park","userId":"03524589898640390729"}}},"outputs":[],"source":["np.random.seed(0)  #random에 대한 실행결과를 고정.!!\n","\n","def reverse_num(values):\n","    output = np.empty(len(values))\n","    \n","    for i in range(len(values)):\n","        output[i] = 1.0 / values[i]\n","    \n","    return output"]},{"cell_type":"code","execution_count":54,"metadata":{"id":"aagBlNXs1Pas","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1682868526351,"user_tz":-540,"elapsed":37,"user":{"displayName":"kiyong park","userId":"03524589898640390729"}},"outputId":"7352bf5b-c8bc-4754-efea-ac71fbc9e883"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([45, 48, 65, ..., 93, 62, 19])"]},"metadata":{},"execution_count":54}],"source":["# 1부터 100까지 범위에서 1000000개를 랜덤으로 뽑아서 array를 만듭니다.\n","big_array = np.random.randint(1,100,1000000)\n","big_array"]},{"cell_type":"code","source":["big_array.shape"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"KtqB1uxgwR5m","executionInfo":{"status":"ok","timestamp":1682868526351,"user_tz":-540,"elapsed":33,"user":{"displayName":"kiyong park","userId":"03524589898640390729"}},"outputId":"7b89ee65-e5c3-4fe4-d1ae-1ae52af42249"},"execution_count":55,"outputs":[{"output_type":"execute_result","data":{"text/plain":["(1000000,)"]},"metadata":{},"execution_count":55}]},{"cell_type":"code","execution_count":56,"metadata":{"id":"VMyEUiVM1Pas","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1682868550471,"user_tz":-540,"elapsed":24149,"user":{"displayName":"kiyong park","userId":"03524589898640390729"}},"outputId":"e8cd6808-7d3f-492b-dc9f-0176a1afe689"},"outputs":[{"output_type":"stream","name":"stdout","text":["3.15 s ± 1.48 s per loop (mean ± std. dev. of 7 runs, 1 loop each)\n"]}],"source":["%timeit reverse_num(big_array)  ## %tieimt 노트북 계열에서 수행 시간을 표시 한다"]},{"cell_type":"code","execution_count":57,"metadata":{"id":"k7PvHI7-1Pas","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1682868563225,"user_tz":-540,"elapsed":12776,"user":{"displayName":"kiyong park","userId":"03524589898640390729"}},"outputId":"ed3f9eac-782e-45f5-ddde-d99364a563cf"},"outputs":[{"output_type":"stream","name":"stdout","text":["1.53 ms ± 183 µs per loop (mean ± std. dev. of 7 runs, 1000 loops each)\n"]}],"source":["%timeit 1.0 / big_array  ## numpy 가 유니버셜 펑션을 썼을때 빠르다.데이터가 많을 때"]},{"cell_type":"markdown","source":["# 과제\n","1.실수로 이루어진 20 x 6 형태의 데이터 행렬을 만들고 이 데이터에 대해 다음과 같은 값을 구한다.\n","\n","- 전체의 최댓값\n","\n","- 각 행의 합\n","\n","- 각 행의 최댓값\n","\n","- 각 열의 평균\n","\n","- 각 열의 최솟값\n","\n","2.가격이 20,000원인 주식이 있다. 이 주식의 일간 수익률(%)은 기댓값이 0%이고 표준편차가 1%인 표준 정규 분포를 따른다고 하자. 365일 동안의 주가를 무작위로 생성하라."],"metadata":{"id":"iIpGVsUK863z"}}],"metadata":{"kernelspec":{"display_name":"Python 3 (ipykernel)","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.8.2"},"colab":{"provenance":[{"file_id":"1IgKcbSDIfnFXTq-DPT1VUeC7CKt7Y58y","timestamp":1674046842507}]}},"nbformat":4,"nbformat_minor":0}